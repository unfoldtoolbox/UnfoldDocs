<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/UnfoldDocs/'</script><script charset="utf-8" src="../../../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Overlap corrected LDA · UnfoldDecode.jl</title><meta content="Overlap corrected LDA · UnfoldDecode.jl" name="title"/><meta content="Overlap corrected LDA · UnfoldDecode.jl" property="og:title"/><meta content="Overlap corrected LDA · UnfoldDecode.jl" property="twitter:title"/><meta content="Documentation for UnfoldDecode.jl." name="description"/><meta content="Documentation for UnfoldDecode.jl." property="og:description"/><meta content="Documentation for UnfoldDecode.jl." property="twitter:description"/><script data-outdated-warner="" src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script data-main="../../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" data-theme-name="catppuccin-mocha" href="../../../assets/themes/catppuccin-mocha.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-macchiato" href="../../../assets/themes/catppuccin-macchiato.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-frappe" href="../../../assets/themes/catppuccin-frappe.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-latte" href="../../../assets/themes/catppuccin-latte.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../../assets/themeswap.js"></script><link href="https://unfoldtoolbox.github.io/UnfoldDocs/UnfoldDecode.jl/dev/generated/tutorials/overlapcorrectedLDA/" rel="canonical"/><link href="../../../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/><link href="../../../../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../../../main/"><div class="homebutton">Home</div></a><a class="nav-link nav-item" href="../../../../../Unfold.jl/"><div class="headertitle"> Analysis </div><br/> Unfold<span style="color:#ccc;"></span>.jl</a><a class="nav-link nav-item" href="../../../../../UnfoldMixedModels.jl/"><div class="headertitle"> LMM </div><br/> Unfold<span style="color:#197BDD;">MixedModels</span>.jl</a><a class="nav-link nav-item" href="../../../../../UnfoldMakie.jl/"><div class="headertitle"> Visualization </div><br/> Unfold<span style="color:#3AAA35;">Makie</span>.jl</a><a class="nav-link nav-item" href="../../../../../UnfoldSim.jl/"><div class="headertitle"> Simulation </div><br/> Unfold<span style="color:#E6007E;">Sim</span>.jl</a><a class="nav-link nav-item" href="../../../../../UnfoldBIDS.jl/"><div class="headertitle"> Pipeline </div><br/> Unfold<span style="color:#FEC700;">BIDS</span>.jl</a><a class="nav-link nav-item" href="../../../../../UnfoldStats.jl/"><div class="headertitle"> Statistics </div><br/> Unfold<span style="color:#E30613;">Stats</span>.jl</a><a class="nav-link active nav-item" href="../../../../"><div class="headertitle"> Decoding </div><br/> Unfold<span style="color:#009BA4;">Decode</span>.jl</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Related Tools</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../../../ClusterDepth.jl/"><div class="headertitle">Multiple Comparisons with ClusterDepth.jl</div></a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">UnfoldDecode.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">tutorials</span><ul><li class="is-active"><a class="tocitem" href="">Overlap corrected LDA</a><ul class="internal"><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Overlap-model-Definition"><span>Overlap-model Definition</span></a></li><li><a class="tocitem" href="#Fitting-the-Overlap-corrected-LDA-model"><span>Fitting the Overlap-corrected LDA model</span></a></li></ul></li></ul></li><li><span class="tocitem">HowTo</span><ul><li><a class="tocitem" href="../../HowTo/overlapcorrectedLDA_options/">Overlap corrected, multi-event, many options, LDA</a></li></ul></li><li><span class="tocitem">BackToBack</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../b2b_quickstart/">Quick Start b2b</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanations/b2b_why/">Why Back2Back</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/b2b_algorithms/">Algorithm choice</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">tutorials</a></li><li class="is-active"><a href="">Overlap corrected LDA</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Overlap corrected LDA</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/UnfoldDecode.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/UnfoldDecode.jl/blob/main/docs/literate/tutorials/overlapcorrectedLDA.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><pre><code class="language-julia hljs">using UnfoldDecode
using UnfoldSim
using UnfoldMakie
using CairoMakie
using Unfold</code></pre><h1 id="Overlap-corrected-decoding"><a class="docs-heading-anchor" href="#Overlap-corrected-decoding">Overlap-corrected decoding</a><a id="Overlap-corrected-decoding-1"></a><a class="docs-heading-anchor-permalink" href="#Overlap-corrected-decoding" title="Permalink"></a></h1><p>This approach follows the work of the Deoulle Group, especially Gal Vishne's work as published 2023: https://doi.org/10.1101/2023.06.28.546397</p><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><p>We start with simulating some continuous, overlapping data with two conditions. As of now, <code>UnfoldSim</code> doesnt support multichannel, so we simply repeat the channel and add some noise`</p><pre><code class="language-julia hljs">dat, evt = UnfoldSim.predef_eeg()
dat = repeat(dat', 5)
dat .= dat .+ 20 .* rand(size(dat)...)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5×120199 Matrix{Float64}:
 16.7342   15.9419    1.75695  14.0294   …  12.4566   16.6761     1.37595
 18.3178   15.326    13.8085    5.41718     12.5513    2.51877    7.55932
  6.87276   2.16311  12.0447   17.398       14.207     0.873056  18.2972
  8.47761  19.7291   15.0852    6.2834       2.6239    8.93969    1.80127
  9.49856  17.9427    1.92481   6.13387      9.15272  11.3014     4.77343</code></pre><h2 id="Overlap-model-Definition"><a class="docs-heading-anchor" href="#Overlap-model-Definition">Overlap-model Definition</a><a id="Overlap-model-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Overlap-model-Definition" title="Permalink"></a></h2><p>We have to define what model we want to use for overlap correction We decide for a one-basisfunction model, with one one condition and one covariate, from <code>-0.1</code> to <code>0.5</code> seconds afte the stimulus onset. Sampling rate <code>100</code> as in the simulation</p><pre><code class="language-julia hljs">des = [Any =&gt; (@formula(0 ~ 1 + condition + continuous), firbasis((-0.1, 1.0), 100))];</code></pre><p>Fitting and visualizing a single channel of the model</p><pre><code class="language-julia hljs">uf = Unfold.fit(UnfoldModel, des, evt, dat[1, :]);
plot_erp(coeftable(uf))</code></pre><img alt="Example block output" src="677735ca.png"/><h2 id="Fitting-the-Overlap-corrected-LDA-model"><a class="docs-heading-anchor" href="#Fitting-the-Overlap-corrected-LDA-model">Fitting the Overlap-corrected LDA model</a><a id="Fitting-the-Overlap-corrected-LDA-model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-the-Overlap-corrected-LDA-model" title="Permalink"></a></h2><p>Following the <a href="https://alan-turing-institute.github.io/MLJ.jl/dev/list_of_supported_models/">MLJ Modelzoo</a> we have to do the following to load an LDA model</p><pre><code class="language- hljs">using MLJ, MultivariateStats, MLJMultivariateStatsInterface
LDA = @load LDA pkg = MultivariateStats
uf_lda =
    Unfold.fit(UnfoldDecodingModel, des, evt, dat, LDA(), Any =&gt; :condition; nfolds = 2) # 2 folds to speed up computation
plot_erp(coeftable(uf_lda); mapping = (; color = :coefname))</code></pre><p>Voila, the model classified the correct period.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../">« Home</a><a class="docs-footer-nextpage" href="../../HowTo/overlapcorrectedLDA_options/">Overlap corrected, multi-event, many options, LDA »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 28 February 2025 14:45">Friday 28 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>