<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/UnfoldDocs/'</script><script charset="utf-8" src="../../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Basisfunctions Â· Unfold.jl Timeseries Analysis &amp; Deconvolution</title><meta content="Basisfunctions Â· Unfold.jl Timeseries Analysis &amp; Deconvolution" name="title"/><meta content="Basisfunctions Â· Unfold.jl Timeseries Analysis &amp; Deconvolution" property="og:title"/><meta content="Basisfunctions Â· Unfold.jl Timeseries Analysis &amp; Deconvolution" property="twitter:title"/><meta content="Documentation for Unfold.jl Timeseries Analysis &amp; Deconvolution." name="description"/><meta content="Documentation for Unfold.jl Timeseries Analysis &amp; Deconvolution." property="og:description"/><meta content="Documentation for Unfold.jl Timeseries Analysis &amp; Deconvolution." property="twitter:description"/><meta content="https://unfoldtoolbox.github.io/Unfold.jl/explanations/basisfunctions/" property="og:url"/><meta content="https://unfoldtoolbox.github.io/Unfold.jl/explanations/basisfunctions/" property="twitter:url"/><link href="https://unfoldtoolbox.github.io/UnfoldDocs/Unfold.jl/stable/explanations/basisfunctions/" rel="canonical"/><script data-outdated-warner="" src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" data-theme-name="catppuccin-mocha" href="../../assets/themes/catppuccin-mocha.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-macchiato" href="../../assets/themes/catppuccin-macchiato.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-frappe" href="../../assets/themes/catppuccin-frappe.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-latte" href="../../assets/themes/catppuccin-latte.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../assets/themeswap.js"></script><link href="../../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/><link href="../../../../assets/style.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../../main/"><div class="homebutton">Home</div></a><a class="nav-link active nav-item" href="../../../"><div class="headertitle"> Analysis </div><br/> Unfold<span style="color:#ccc;"></span>.jl</a><a class="nav-link nav-item" href="../../../../UnfoldMixedModels.jl/"><div class="headertitle"> LMM </div><br/> Unfold<span style="color:#197BDD;">MixedModels</span>.jl</a><a class="nav-link nav-item" href="../../../../UnfoldMakie.jl/"><div class="headertitle"> Visualization </div><br/> Unfold<span style="color:#3AAA35;">Makie</span>.jl</a><a class="nav-link nav-item" href="../../../../UnfoldSim.jl/"><div class="headertitle"> Simulation </div><br/> Unfold<span style="color:#E6007E;">Sim</span>.jl</a><a class="nav-link nav-item" href="../../../../UnfoldBIDS.jl/"><div class="headertitle"> Pipeline </div><br/> Unfold<span style="color:#FEC700;">BIDS</span>.jl</a><a class="nav-link nav-item" href="../../../../UnfoldStats.jl/"><div class="headertitle"> Statistics </div><br/> Unfold<span style="color:#E30613;">Stats</span>.jl</a><a class="nav-link nav-item" href="../../../../UnfoldDecode.jl/"><div class="headertitle"> Decoding </div><br/> Unfold<span style="color:#009BA4;">Decode</span>.jl</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Related Tools</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../../ClusterDepth.jl/"><div class="headertitle">Multiple Comparisons with ClusterDepth.jl</div></a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img alt="Unfold.jl Timeseries Analysis &amp; Deconvolution logo" src="../../assets/logo.png"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Unfold.jl Documentation</a></li><li><a class="tocitem" href="../../installation/">Installing Julia + Unfold.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/lm_mu/">rERP (mass univariate)</a></li><li><a class="tocitem" href="../../tutorials/lm_overlap/">rERP (overlap correction)</a></li></ul></li><li><span class="tocitem">HowTo</span><ul><li><a class="tocitem" href="../../HowTo/multiple_events/">Multiple events</a></li><li><a class="tocitem" href="../../generated/HowTo/contrasts/">Change contrasts / coding schema</a></li><li><a class="tocitem" href="../../generated/HowTo/baddata/">Mark bad data segments</a></li><li><a class="tocitem" href="../../HowTo/standarderrors/">Standard errors</a></li><li><a class="tocitem" href="../../generated/HowTo/effects/">Marginal effects (must read re: splines)</a></li><li><a class="tocitem" href="../../generated/HowTo/circular_splines/">Circular splines</a></li><li><a class="tocitem" href="../../HowTo/custom_solvers/">Alternative Solvers (Robust, GPU, B2B)</a></li><li><a class="tocitem" href="../../generated/HowTo/unfold_io/">Save and load Unfold models</a></li><li><a class="tocitem" href="../../generated/HowTo/FIRduration/">Duration-scaled basisfunctions (Hassall-style)</a></li><li><a class="tocitem" href="../../generated/HowTo/eventhandling/">Tools to modify/transform/translate events</a></li><li><a class="tocitem" href="../../HowTo/pymne/">ğŸ Import EEG with PyMNE.jl</a></li><li><a class="tocitem" href="../../generated/HowTo/juliacall_unfold/">ğŸ Calling Unfold.jl directly from Python</a></li><li><a class="tocitem" href="../../HowTo/R/">R: Calling Unfold.jl directly from R</a></li></ul></li><li><span class="tocitem">Explanations</span><ul><li><a class="tocitem" href="../../generated/explanations/nonlinear_effects/">Non-Linear effects</a></li><li class="is-active"><a class="tocitem" href="">Basisfunctions</a><ul class="internal"><li><a class="tocitem" href="#HRF-/-BOLD"><span>HRF / BOLD</span></a></li><li><a class="tocitem" href="#FIR-Basis-Function"><span>FIR Basis Function</span></a></li></ul></li><li><a class="tocitem" href="../../generated/explanations/predict/">Predictions</a></li><li><a class="tocitem" href="../../generated/explanations/window_length/">Window Length Effect</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../references/extensions/">Overview of package extensions</a></li><li><a class="tocitem" href="../../generated/references/solver/">Solver/optimizer implementations</a></li><li><a class="tocitem" href="../../references/benchmarks/">Solver benchmarks</a></li><li><a class="tocitem" href="../../references/types/">API: Types</a></li><li><a class="tocitem" href="../../references/functions/">API: Functions</a></li></ul></li><li><span class="tocitem">Contributing</span><ul><li><a class="tocitem" href="../../90-contributing/">Contributing guidelines</a></li></ul></li><li><span class="tocitem">Developer Guide</span><ul><li><a class="tocitem" href="../../91-developer/">Developer documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanations</a></li><li class="is-active"><a href="">Basisfunctions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Basisfunctions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/Unfold.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/unfoldtoolbox/Unfold.jl/blob/main/docs/src/explanations/basisfunctions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basis-Functions"><a class="docs-heading-anchor" href="#Basis-Functions">Basis Functions</a><a id="Basis-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Basis-Functions" title="Permalink"></a></h1><p>This document will give you an explanation of basis functions. We start with basis functions for fMRI because they are very popular.</p><h2 id="HRF-/-BOLD"><a class="docs-heading-anchor" href="#HRF-/-BOLD">HRF / BOLD</a><a id="HRF-/-BOLD-1"></a><a class="docs-heading-anchor-permalink" href="#HRF-/-BOLD" title="Permalink"></a></h2><p>We want to define a basis function. There are currently only few basisfunctions implemented in Unfold.jl, but your imagination knows no borders!</p><p>We first have a look at the BOLD-HRF basisfunction aka <a href="https://en.wikipedia.org/wiki/Blood-oxygen-level-dependent_imaging">Blood Oxygenation Level Dependent Hemodynamic Response Function</a>:</p><pre><code class="language-julia hljs">using Unfold, DSP

TR = 1.5 # the sampling rate
bold = hrfbasis(TR) # using default SPM parameters
eventonset = 1.3
bold_kernel = e -&gt; Unfold.kernel(bold, e)
lines(bold_kernel(eventonset)[:,1]) # returns a matrix, thus [:, 1]</code></pre><img alt="Example block output" src="cb208fac.png"/><p>This is the shape that is assumed to reflect the activity for an event. Generally, we would like to know how much to scale this response shape per condition, e.g. in <code>condA</code> we might scale it by 0.7, in <code>condB</code> by 1.2.</p><p>But let's start at the beginning and first simulate an fMRI signal. Then you will also appreciate why we need to deconvolve it later.</p><h3 id="Convolving-a-response-shape-to-get-a-&quot;recorded&quot;-fMRI-signal"><a class="docs-heading-anchor" href="#Convolving-a-response-shape-to-get-a-&quot;recorded&quot;-fMRI-signal">Convolving a response shape to get a "recorded" fMRI signal</a><a id="Convolving-a-response-shape-to-get-a-&quot;recorded&quot;-fMRI-signal-1"></a><a class="docs-heading-anchor-permalink" href="#Convolving-a-response-shape-to-get-a-&quot;recorded&quot;-fMRI-signal" title="Permalink"></a></h3><p>We start by convolving this HRF function with an impulse vector at event onsets.</p><pre><code class="language-julia hljs">y = zeros(100) # signal length = 100
y[[10, 30, 45]] .= 0.7 # 3 events at given for condition A
y[[37]] .= 1.2 # 1 events at given for condition B

y_conv = conv(y, bold_kernel(0)) # convolve!
lines(y_conv[:,1])</code></pre><img alt="Example block output" src="aaf5c728.png"/><p>Next, we would add some noise:</p><pre><code class="language-julia hljs">using Random
y_conv += randn(size(y_conv))
lines(y_conv[:,1])</code></pre><img alt="Example block output" src="dc14b6c8.png"/><p>ğŸ‰ - we did it, we simulated fMRI data.</p><p>Now you can see that the conditions overlap in time. To get back to the original amplitude values, we need to specify a basis function and use Unfold to deconvolve the signals.</p><div class="admonition is-info" id="Note-3ff012dc4399d184"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-3ff012dc4399d184" title="Permalink"></a></header><div class="admonition-body"><p>Events can fall between TR (the sampling rate). Some packages subsample the time signal, but in <code>Unfold</code> we can call the <code>bold.kernel</code> function directly at a given event time, which allows us to use non-TR multiples.</p></div></div><h2 id="FIR-Basis-Function"><a class="docs-heading-anchor" href="#FIR-Basis-Function">FIR Basis Function</a><a id="FIR-Basis-Function-1"></a><a class="docs-heading-anchor-permalink" href="#FIR-Basis-Function" title="Permalink"></a></h2><p>Okay, let's have a look at a different basis function: The FIR basisfunction. FIR stands for <a href="https://en.wikipedia.org/wiki/Finite_impulse_response">Finite-Impulse-Response</a> and is a term taken from the filtering literature.</p><pre><code class="language-julia hljs">basisfunction = firbasis(Ï„=(-0.4,.8), sfreq=50, name="myFIRbasis")
fir_kernel = e -&gt; Unfold.kernel(basisfunction, e)
m = fir_kernel(0)
f = Figure()
f[1,1] = Axis(f)
for col = 1:size(m, 2)
    lines!(m[:,col])
end
current_figure()</code></pre><img alt="Example block output" src="9259f847.png"/><p>The first thing to notice is that it is not a single basisfunction, but a set of basisfunctions. So every condition is explained by several basis functions!</p><p>To make it clear better show it in 2D:</p><pre><code class="language-julia hljs">fir_kernel(0)[1:10,1:10]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10Ã—10 SparseArrays.SparseMatrixCSC{Int64, Int64} with 10 stored entries:
 1  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…
 â‹…  1  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…
 â‹…  â‹…  1  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…
 â‹…  â‹…  â‹…  1  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…
 â‹…  â‹…  â‹…  â‹…  1  â‹…  â‹…  â‹…  â‹…  â‹…
 â‹…  â‹…  â‹…  â‹…  â‹…  1  â‹…  â‹…  â‹…  â‹…
 â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  1  â‹…  â‹…  â‹…
 â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  1  â‹…  â‹…
 â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  1  â‹…
 â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  â‹…  1</code></pre><p>(all <code>.</code> are <code>0</code>'s)</p><p>The FIR basis set consists of multiple basis functions. That is, each event is now <em>time-expanded</em> to multiple predictors, each with a certain time delay to the event onset. This allows us to model any linear overlap shape, and doesn't force us to make assumptions about the convolution kernel, as we had to do in the BOLD case.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../generated/explanations/nonlinear_effects/">Â« Non-Linear effects</a><a class="docs-footer-nextpage" href="../../generated/explanations/predict/">Predictions Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 15 January 2026 10:31">Thursday 15 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>